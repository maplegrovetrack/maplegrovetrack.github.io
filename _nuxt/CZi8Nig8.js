import{ad as O,w as k,b as x,bb as F,G as v,Q as d,a4 as f,am as y,a3 as _,A as c,a9 as u,k as w,bh as G,R as I,U as Q,S as H,V as q,ai as J,bi as K,a5 as W,ab as X}from"./4KWQtrrF.js";import{a as Y,h as Z,_ as E,t as P}from"./ADBGOafX.js";import ee from"./Dqnqzxpb.js";import"./DnfJu2fy.js";const le={slots:{root:"relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-muted rounded-md",list:"isolate relative p-2 border-b lg:border-b-0 lg:border-e border-muted overflow-y-auto",item:"",listWithChildren:"ms-4.5 border-s border-default",itemWithChildren:"ps-1.5 -ms-px",link:"relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"size-4 shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"size-5 transform transition-transform duration-200 shrink-0 group-data-expanded:rotate-180",content:"overflow-hidden lg:col-span-2 flex flex-col [&>div]:my-0 [&>div]:flex-1 [&>div]:flex [&>div]:flex-col [&>div>div]:border-0 [&>div>pre]:border-b-0 [&>div>pre]:border-s-0 [&>div>pre]:border-e-0 [&>div>pre]:rounded-l-none [&>div>pre]:flex-1 [&>div]:overflow-y-auto"},variants:{active:{true:{link:"text-highlighted before:bg-elevated"},false:{link:["hover:text-highlighted hover:before:bg-elevated/50","transition-colors before:transition-colors"]}}}},ie=Object.assign({inheritAttrs:!1},{__name:"ProseCodeTree",props:{items:{type:Array,required:!1},modelValue:{type:String,required:!1},defaultValue:{type:String,required:!1},expandAll:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},emits:["update:modelValue"],setup(z,{emit:D}){const a=z,R=D,U=O(),b=Y(),[N,L]=Z(),o=w(()=>P({extend:P(le),...b.ui?.prose?.codeTree||{}})()),A=a.modelValue??a.defaultValue,p=x(A?{path:A}:void 0),S=x();k(p,e=>{e?.path!==a.modelValue&&R("update:modelValue",e?.path)}),k(()=>a.modelValue,e=>{if(e===p.value?.path)return;p.value=e?{path:e}:void 0;const t=T(e);for(const l of t)m.value.includes(l)||m.value.push(l)});const $=x(1),g=w(()=>($.value,a.items||U.default?.()?.flatMap(j).filter(Boolean)||[])),B=w(()=>M(g.value));function M(e){const t=new Map,l=[];e.forEach(n=>{const s=n.label.split("/");let r="";s.forEach((h,C)=>{if(r=r?`${r}/${h}`:h,!t.has(r)){const V={label:h,path:r,...C<s.length-1&&{children:[]}};t.set(r,V),C===0?l.push(V):t.get(s.slice(0,C).join("/"))?.children?.push(V)}})});const i=n=>n.sort((s,r)=>!!s.children==!!r.children?s.label.localeCompare(r.label):r.children?1:-1).map(s=>({...s,children:s.children&&i(s.children)}));return i(l)}function j(e,t){return typeof e.type=="symbol"?e.children?.map(j):{label:e.props?.filename||e.props?.label||`${t}`,icon:e.props?.icon,component:e}}function T(e){if(a.expandAll){const l=new Set;return g.value.forEach(i=>{const n=i.label.split("/");for(let s=1;s<n.length;s++)l.add(n.slice(0,s).join("/"))}),Array.from(l)}if(!e)return[];const t=e.split("/");return t.slice(0,-1).map((l,i)=>t.slice(0,i+1).join("/"))}const m=x(T(p.value?.path));return k(g,(e,t)=>{if(!a.expandAll)return;const l=e.map(n=>n.label).join(`
`),i=t?.map(n=>n.label).join(`
`)??"";l!==i&&(m.value=T())}),k(p,e=>{const t=g.value.find(l=>e?.path===l.label);t?.component&&(S.value=t)},{immediate:!0}),F(()=>$.value++),(e,t)=>(d(),v(q,null,[f(c(N),null,{default:_(({items:l,level:i})=>[(d(!0),v(q,null,J(l,(n,s)=>(d(),v("li",{key:`${i}-${s}`,role:"presentation",class:u(i>1?o.value.itemWithChildren({class:a.ui?.itemWithChildren}):o.value.item({class:a.ui?.item}))},[f(c(K),{level:i,value:n,"as-child":""},{default:_(({isExpanded:r,isSelected:h})=>[y("button",{type:"button",class:u(o.value.link({class:a.ui?.link,active:h}))},[n.children?.length?(d(),I(E,{key:0,name:r?c(b).ui.icons.folderOpen:c(b).ui.icons.folder,class:u(o.value.linkLeadingIcon({class:a.ui?.linkLeadingIcon}))},null,8,["name","class"])):(d(),I(ee,{key:1,filename:n.label,class:u(o.value.linkLeadingIcon({class:a.ui?.linkLeadingIcon}))},null,8,["filename","class"])),y("span",{class:u(o.value.linkLabel({class:a.ui?.linkLabel}))},X(n.label),3),n.children?.length?(d(),v("span",{key:2,class:u(o.value.linkTrailing({class:a.ui?.linkTrailing}))},[f(E,{name:c(b).ui.icons.chevronDown,class:u(o.value.linkTrailingIcon({class:a.ui?.linkTrailingIcon}))},null,8,["name","class"])],2)):W("",!0)],2),n.children?.length&&r?(d(),v("ul",{key:0,role:"group",class:u(o.value.listWithChildren({class:a.ui?.listWithChildren}))},[f(c(L),{items:n.children,level:i+1},null,8,["items","level"])],2)):W("",!0)]),_:2},1032,["level","value"])],2))),128))]),_:1}),y("div",H(e.$attrs,{class:o.value.root({class:[a.ui?.root,a.class]})}),[f(c(G),{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=l=>p.value=l),expanded:m.value,"onUpdate:expanded":t[1]||(t[1]=l=>m.value=l),class:u(o.value.list({class:a.ui?.list})),items:B.value,"get-key":l=>l.path},{default:_(()=>[f(c(L),{items:B.value,level:1},null,8,["items"])]),_:1},8,["modelValue","expanded","class","items","get-key"]),y("div",{class:u(o.value.content({class:a.ui?.content}))},[(d(),I(Q(S.value?.component)))],2)],16)],64))}});export{ie as default};
